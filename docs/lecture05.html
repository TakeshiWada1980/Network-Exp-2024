<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <meta name="robots" content="noindex,nofollow,noarchive" />
    <meta name="referrer" content="no-referrer" />

    <script>
      MathJax = {
        chtml: {
          displayAlign: "left",
          displayIndent: "1em",
        },
      };
    </script>

    

    <link rel="icon" href="favicon.ico" sizes="any" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c"
    />
    <link rel="stylesheet" href="style.css" />

    <title>第05回 後期 4H 実験実習</title>
  </head>

  <body>
    <div class="openbtn"><span></span><span></span><span></span></div>
    <nav id="g-nav">
      <div id="g-nav-list">
        <!-- ---------------------------------------- -->
         <ul>
<li><a href="#各種連絡" id="toc-各種連絡"><span class="toc-section-number">1</span>
各種連絡</a></li>
<li><a href="#準備-復習" id="toc-準備-復習"><span class="toc-section-number">2</span> 準備
(復習)</a></li>
<li><a href="#appsscriptの実行-復習" id="toc-appsscriptの実行-復習"><span
class="toc-section-number">3</span> AppsScriptの実行 (復習)</a>
<ul>
<li><a href="#ショートカットキー" id="toc-ショートカットキー"><span
class="toc-section-number">3.1</span> ショートカットキー</a></li>
</ul></li>
<li><a href="#配列" id="toc-配列"><span class="toc-section-number">4</span> 配列</a>
<ul>
<li><a href="#複数セルに一括して値を設定" id="toc-複数セルに一括して値を設定"><span
class="toc-section-number">4.1</span> 複数セルに一括して値を設定</a></li>
<li><a href="#配列要素の動的拡張" id="toc-配列要素の動的拡張"><span
class="toc-section-number">4.2</span> 配列要素の動的拡張</a></li>
<li><a href="#配列からランダムに要素を選択する処理"
id="toc-配列からランダムに要素を選択する処理"><span class="toc-section-number">4.3</span>
配列からランダムに要素を選択する処理</a></li>
</ul></li>
<li><a href="#プログラムのファイル分割" id="toc-プログラムのファイル分割"><span
class="toc-section-number">5</span> プログラムのファイル分割</a></li>
<li><a href="#セルの色の設定" id="toc-セルの色の設定"><span class="toc-section-number">6</span>
セルの色の設定</a></li>
<li><a href="#時間に関する演算" id="toc-時間に関する演算"><span class="toc-section-number">7</span>
時間に関する演算</a></li>
<li><a href="#urlパラメータの処理" id="toc-urlパラメータの処理"><span
class="toc-section-number">8</span> URLパラメータの処理</a>
<ul>
<li><a href="#準備と復習" id="toc-準備と復習"><span class="toc-section-number">8.1</span>
準備と復習</a></li>
<li><a href="#python-からのウェブapiの実行テスト" id="toc-python-からのウェブapiの実行テスト"><span
class="toc-section-number">8.2</span> Python からのウェブAPIの実行テスト</a></li>
<li><a href="#urlパラメータに応じた処理の分岐" id="toc-urlパラメータに応じた処理の分岐"><span
class="toc-section-number">8.3</span> URLパラメータに応じた処理の分岐</a></li>
<li><a href="#json形式のレスポンス" id="toc-json形式のレスポンス"><span
class="toc-section-number">8.4</span> JSON形式のレスポンス</a></li>
</ul></li>
<li><a href="#html-のレスポンス" id="toc-html-のレスポンス"><span
class="toc-section-number">9</span> HTML のレスポンス</a>
<ul>
<li><a href="#サンプル" id="toc-サンプル"><span class="toc-section-number">9.1</span>
サンプル</a></li>
</ul></li>
<li><a href="#ウェブアプリの構築" id="toc-ウェブアプリの構築"><span
class="toc-section-number">10</span> ウェブアプリの構築</a>
<ul>
<li><a href="#サーバサイド-バックエンド" id="toc-サーバサイド-バックエンド"><span
class="toc-section-number">10.1</span> サーバサイド (バックエンド)</a></li>
<li><a href="#クライアントサイド-フロントエンド" id="toc-クライアントサイド-フロントエンド"><span
class="toc-section-number">10.2</span> クライアントサイド (フロントエンド)</a></li>
</ul></li>
</ul> 
        <!-- ---------------------------------------- -->
      </div>
    </nav>

    <header class="markdown-body">
      <p>2024-4H 電子機械工学実験実習I (後期) 第05回 講義資料</p>
      <p>毎週金曜日 5～8時限</p>
    </header>

    <main class="markdown-body">
      <!-- ---------------------------------------- -->
      <h1 data-number="1" id="各種連絡"><span class="header-section-number">1</span> 各種連絡</h1>
      <ul>
      <li>FTE 工場見学・会社見学に関する案内</li>
      </ul>
      <h1 data-number="2" id="準備-復習"><span class="header-section-number">2</span> 準備
      (復習)</h1>
      <p>学校標準のGoogleアカウントで GoogleWorkspace
      にログインして、Googleスプレッドシートを新規作成して、ファイル名を
      <code>GasApp02_NN_Name</code> に変更してください。出席番号「3番」の「高専太郎」の場合は
      <code>GasApp02_03_高専太郎</code> となるはずです。</p>
      <ul>
      <li><a href="lecture04.html">前回</a>に作成したファイルは <code>GasApp01_...</code> で、今回は
      <code>GasApp02_...</code> になります。</li>
      </ul>
      <p>また、前回と同じ手順で<a
      href="lecture04.html#スプレッドシートにおける-apps-script-の有効化">Apps Script
      の有効化</a>をしてください。プロジェクト名は <code>GasApp02_03_高専太郎</code>
      としてください。</p>
      <ul>
      <li><a href="https://script.google.com/home">プロジェクト管理ページ</a></li>
      </ul>
      <h1 data-number="3" id="appsscriptの実行-復習"><span class="header-section-number">3</span>
      AppsScriptの実行 (復習)</h1>
      <p>プロジェクトを有効化したら、<code>コード.gs</code> 次のプログラムを貼付けてください。</p>
      <div class="sourceCode" id="cb1" data-caption="AppsScriptの実行と動作確認"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">function</span> <span class="fu">getDiceNum</span>(n) {</span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>()<span class="op">*</span>n<span class="op">+</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>}</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">function</span> <span class="fu">writeValue_01</span>() {</span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="kw">let</span> t <span class="op">=</span> <span class="st">&#39;A1&#39;</span><span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="kw">let</span> r <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSheet</span>()<span class="op">.</span><span class="fu">getRange</span>(t)<span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>  x <span class="op">=</span> <span class="fu">getDiceNum</span>(<span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>  r<span class="op">.</span><span class="fu">setValue</span>(x)<span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`セル </span><span class="sc">${</span>t<span class="sc">}</span><span class="vs"> に </span><span class="sc">${</span>x<span class="sc">}</span><span class="vs"> を書き込みました。`</span>)<span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>}</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="kw">function</span> <span class="fu">onOpen</span>() {</span>
<span id="cb1-14"><a href="#cb1-14"></a>  <span class="kw">const</span> ui <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getUi</span>()<span class="op">;</span></span>
<span id="cb1-15"><a href="#cb1-15"></a>  ui<span class="op">.</span><span class="fu">createMenu</span>(<span class="st">&#39;GAS-1&#39;</span>)</span>
<span id="cb1-16"><a href="#cb1-16"></a>    <span class="op">.</span><span class="fu">addItem</span>(<span class="st">&#39;セルA1に乱数をセット&#39;</span><span class="op">,</span> <span class="st">&#39;writeValue_01&#39;</span>)</span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="op">.</span><span class="fu">addToUi</span>()<span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>}</span></code></pre></div>
      <p>次のことを確認してください。</p>
      <ul>
      <li>「<strong>Gasタブ</strong>」から <code>writeValue_01</code> が実行できること。</li>
      <li>「<strong>シートタブ</strong> (要リロード)」のメニューから上記関数が実行できること</li>
      <li>プログラムの各行の意味</li>
      </ul>
      <p>意図したような動作をしない場合、前回の<a
      href="lecture04.html#開発に際しての注意点">開発に際しての注意点</a>を確認して対処してください。</p>
      <h2 data-number="3.1" id="ショートカットキー"><span class="header-section-number">3.1</span>
      ショートカットキー</h2>
      <p>次のショートカットキーを利用するようにしてください。</p>
      <ul>
      <li>保存: <code>Ctrl+S</code></li>
      <li>実行: <code>Ctrl+R</code></li>
      <li>コメントアウト/アンコメント: <code>Ctrl+/</code></li>
      <li>整形: <code>Shft+Alt+F</code></li>
      <li>タブの切り替え: <code>Ctrl+Tab</code></li>
      </ul>
      <h1 data-number="4" id="配列"><span class="header-section-number">4</span> 配列</h1>
      <p>Apps Script の「配列」について学びます。</p>
      <h2 data-number="4.1" id="複数セルに一括して値を設定"><span
      class="header-section-number">4.1</span> 複数セルに一括して値を設定</h2>
      <p>Apps Script (JavaScript) では、C言語 (Arduino言語) や Python と同様に
      <code>[10,20,30]</code>
      のようにして配列を与えることができます。また、<code>[[10,20,30],[40,50,60]]</code>
      のようにして <span class="masked">2行3列</span> の2次元配列を与えることができます。</p>
      <p><code>setValues</code> メソッド (≠<code>setValue</code> メソッド)
      に対して、<strong>2次元配列</strong> (≠1次元配列) を引数に与えれば <span
      class="masked">「セル範囲」に一括して値を設定</span> することができます。</p>
      <div class="sourceCode" id="cb2" data-caption="複数セル (セル範囲) に一括して値を設定"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">function</span> <span class="fu">writeValues_01</span>() {</span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="kw">let</span> arr <span class="op">=</span> [[<span class="dv">10</span><span class="op">,</span><span class="dv">20</span><span class="op">,</span><span class="dv">30</span>]<span class="op">,</span>[<span class="dv">40</span><span class="op">,</span><span class="dv">50</span><span class="op">,</span><span class="dv">60</span>]]<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="kw">let</span> st <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSheet</span>()<span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="kw">let</span> row <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// 行 1から開始</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="kw">let</span> col <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="co">// 列 1から開始</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="kw">let</span> height <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="co">// 高さ(行数) Number of rows</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="kw">let</span> width  <span class="op">=</span> <span class="dv">3</span><span class="op">;</span> <span class="co">// 幅(列数) Number of columns</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="kw">let</span> r <span class="op">=</span> st<span class="op">.</span><span class="fu">getRange</span>(row<span class="op">,</span>col<span class="op">,</span>height<span class="op">,</span>width)<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>  r<span class="op">.</span><span class="fu">setValues</span>(arr)<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>}</span></code></pre></div>
      <p>また、上記の <strong>第08行目</strong> は <code>st.getRange('B1:D2')</code>
      のように<strong>A1参照方式</strong>の文字列を使って与えることもできます。</p>
      <hr />
      <p><strong>演習</strong>: 2次元配列と <code>setValues</code>
      を使って次ようにセル範囲に値を設定せよ (3回に分けて書き込めばよい)。</p>
      <figure>
      <img src="figs/04/sheet-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <ul>
      <li><strong>ヒント</strong>: <span class="masked">3行1列の2次元配列は
      <code>[[30],[40],[50]]</code> のように与えることができる</span></li>
      </ul>
      <h2 data-number="4.2" id="配列要素の動的拡張"><span class="header-section-number">4.2</span>
      配列要素の動的拡張</h2>
      <p>Apps Script では、次のようなコードで動的に <strong>配列を拡張すること</strong>
      ができます。</p>
      <div class="sourceCode" id="cb3" data-caption="配列の動的拡張1"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">function</span> <span class="fu">newArrayTest_01</span>() {</span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="kw">let</span> arr<span class="op">=</span>[]<span class="op">;</span> <span class="co">// 要素数0の「空」の配列」を生成</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="cf">for</span>(<span class="kw">let</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span><span class="dv">5</span><span class="op">;</span>i<span class="op">++</span>){</span>
<span id="cb3-4"><a href="#cb3-4"></a>    arr[i]<span class="op">=</span><span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>()<span class="op">*</span><span class="dv">9</span>)<span class="op">+</span><span class="dv">1</span><span class="op">;</span> <span class="co">// 1～9の乱数</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  }</span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(arr)<span class="op">;</span> <span class="co">// 配列全体を出力</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>}</span></code></pre></div>
      <p><strong>演習1</strong>: <strong>第06行目</strong> の次に <code>console.log(arr[10]);</code>
      を追加して実行するとどうなるか、結果を予測したうえで実際に確認せよ。</p>
      <p><strong>演習2</strong>: <strong>第06行目</strong> の次に <code>console.log(arr[-1]);</code>
      を追加して実行するとどうなるか、結果を予測したうえで実際に確認せよ。Python
      で同様のインデックス指定をした場合との比較を意識すること。</p>
      <p><strong>演習3</strong>:
      次の関数を実行するとどうなるか、結果を予測したうえで実際に確認せよ。</p>
      <div class="sourceCode" id="cb4" data-caption="配列の動的拡張1a"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">function</span> <span class="fu">newArrayTest_01a</span>() {</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="kw">let</span> arr<span class="op">=</span>[]<span class="op">;</span> <span class="co">// 要素数0の「空」の配列」を生成</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  arr[<span class="dv">8</span>]<span class="op">=</span><span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>()<span class="op">*</span><span class="dv">9</span>)<span class="op">+</span><span class="dv">1</span><span class="op">;</span> <span class="co">// a[8]に乱数代入</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(arr)<span class="op">;</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>}</span></code></pre></div>
      <hr />
      <p>同様に <strong>2次元配列</strong> については、次のように動的拡張ができます。</p>
      <div class="sourceCode" id="cb5" data-caption="配列の動的拡張(2次元配列)"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">function</span> <span class="fu">newArrayTest_02</span>() {</span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="kw">let</span> arr<span class="op">=</span>[]<span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="cf">for</span>(<span class="kw">let</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span><span class="dv">3</span><span class="op">;</span>i<span class="op">++</span>){</span>
<span id="cb5-4"><a href="#cb5-4"></a>    arr[i]<span class="op">=</span>[]<span class="op">;</span> <span class="co">// i行目に空の行を作成</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>    <span class="cf">for</span>(<span class="kw">let</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span><span class="dv">5</span><span class="op">;</span>j<span class="op">++</span>){</span>
<span id="cb5-6"><a href="#cb5-6"></a>      arr[i][j]<span class="op">=</span><span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>()<span class="op">*</span><span class="dv">20</span>)<span class="op">+</span><span class="dv">1</span><span class="op">;</span> <span class="co">// 1～9の乱数</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>    }</span>
<span id="cb5-8"><a href="#cb5-8"></a>  }</span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(arr)<span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>}</span></code></pre></div>
      <p><strong>演習4</strong>:
      次のような配列を動的に生成してコンソールに出力する<strong>関数</strong>
      <code>newArrayTest_02a()</code> を作成せよ。</p>
      <pre><code>[ [ 0, 0, 0, 0, 0 ], [ 1, 1, 1, 1, 1 ], [ 2, 2, 2, 2, 2 ] ]</code></pre>
      <p><strong>演習5</strong>:
      次のような配列を動的に生成してコンソールに出力する<strong>関数</strong>
      <code>newArrayTest_02b()</code> を作成せよ。</p>
      <pre><code>[ [ 0, 1, 2, 3, 4 ], [ 0, 1, 2, 3, 4 ], [ 0, 1, 2, 3, 4 ] ]</code></pre>
      <p><strong>演習6</strong>: セル <code>B1:F10</code> の各セルに 1～6 までの乱数 (整数値)
      をセットするような<strong>関数</strong> <code>writeRandNum_01</code>
      を作成せよ。また、「<strong>シートタブ</strong>」のメニューの「<strong>GAS-1</strong>」に「<strong>セルB1:F10に乱数をセット</strong>」という項目を追加し、この関数を呼び出すことができるようにせよ。</p>
      <h2 data-number="4.3" id="配列からランダムに要素を選択する処理"><span
      class="header-section-number">4.3</span> 配列からランダムに要素を選択する処理</h2>
      <div class="sourceCode" id="cb8" data-caption="配列からランダムに要素を選択する処理"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">function</span> <span class="fu">getCard_01</span>() {</span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="kw">let</span> cardRank <span class="op">=</span> [<span class="st">&#39;SSR&#39;</span><span class="op">,</span> <span class="st">&#39;SR&#39;</span><span class="op">,</span> <span class="st">&#39;R&#39;</span><span class="op">,</span> <span class="st">&#39;N&#39;</span>]<span class="op">;</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="kw">let</span> i <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> cardRank<span class="op">.</span><span class="at">length</span>)<span class="op">;</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="cf">return</span> cardRank[i]<span class="op">;</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>}</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="kw">function</span> <span class="fu">tryGacha_01</span>() {</span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="kw">let</span> n <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="kw">let</span> items <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`ガチャを </span><span class="sc">${</span>n<span class="sc">}</span><span class="vs"> 回まわします`</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb8-12"><a href="#cb8-12"></a>    items[i] <span class="op">=</span> <span class="fu">getCard_01</span>()<span class="op">;</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>  }</span>
<span id="cb8-14"><a href="#cb8-14"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(items)<span class="op">;</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>}</span></code></pre></div>
      <p><strong>演習</strong>: ランクに応じた確率でカードが取得されるような関数
      <code>getCard_02</code> を実装せよ。例えば、SSRは10%、SRは20%、Rは30%、Nは40%
      で取得できるようにする。</p>
      <h1 data-number="5" id="プログラムのファイル分割"><span class="header-section-number">5</span>
      プログラムのファイル分割</h1>
      <p>関数単位でファイル分割してプログラムを記述することができます。</p>
      <h1 data-number="6" id="セルの色の設定"><span class="header-section-number">6</span>
      セルの色の設定</h1>
      <p>セルの背景色と文字色は、次のように設定することができます。</p>
      <div class="sourceCode" id="cb9" data-caption="セルの背景色と文字色の操作"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">// 背景色設定</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">function</span> <span class="fu">setBgColor</span>() {</span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="kw">let</span> t <span class="op">=</span> <span class="st">&#39;A1&#39;</span><span class="op">;</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="kw">let</span> r <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSheet</span>()<span class="op">.</span><span class="fu">getRange</span>(t)<span class="op">;</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  r<span class="op">.</span><span class="fu">setBackground</span>(<span class="st">&#39;#FFFF00&#39;</span>)<span class="op">;</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>}</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">// 文字色設定</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="kw">function</span> <span class="fu">setFontColor</span>() {</span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="kw">let</span> t <span class="op">=</span> <span class="st">&#39;A1&#39;</span><span class="op">;</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="kw">let</span> r <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSheet</span>()<span class="op">.</span><span class="fu">getRange</span>(t)<span class="op">;</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>  r<span class="op">.</span><span class="fu">setFontColor</span>(<span class="st">&#39;Red&#39;</span>)<span class="op">;</span> </span>
<span id="cb9-13"><a href="#cb9-13"></a>}</span></code></pre></div>
      <p>次のように <code>rgbToHex</code> 関数を定義すれば「RGBの3つの数値 <code>0</code> ～
      <code>255</code>」により色指定ができます。</p>
      <div class="sourceCode" id="cb10" data-caption="数値による色の設定"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">function</span> <span class="fu">rgbToHex</span>(r<span class="op">,</span> g<span class="op">,</span> b) {</span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="cf">return</span> <span class="st">&#39;#&#39;</span> <span class="op">+</span> ((<span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">24</span>) <span class="op">+</span> (r <span class="op">&lt;&lt;</span> <span class="dv">16</span>) <span class="op">+</span> (g <span class="op">&lt;&lt;</span> <span class="dv">8</span>) <span class="op">+</span> b)<span class="op">.</span><span class="fu">toString</span>(<span class="dv">16</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>}</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">// 文字色設定</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="kw">function</span> <span class="fu">setFontColor</span>() {</span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="kw">let</span> t <span class="op">=</span> <span class="st">&#39;A1&#39;</span><span class="op">;</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="kw">let</span> r <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSheet</span>()<span class="op">.</span><span class="fu">getRange</span>(t)<span class="op">;</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="kw">let</span> c <span class="op">=</span> <span class="fu">rgbToHex</span>(<span class="dv">255</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">255</span>)<span class="op">;</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`c =&gt; </span><span class="sc">${</span>c<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>  r<span class="op">.</span><span class="fu">setFontColor</span>(c)<span class="op">;</span> </span>
<span id="cb10-12"><a href="#cb10-12"></a>}</span></code></pre></div>
      <h1 data-number="7" id="時間に関する演算"><span class="header-section-number">7</span>
      時間に関する演算</h1>
      <div class="sourceCode" id="cb11" data-caption="時間の加算と減算"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">function</span> <span class="fu">calcDatetime_01</span>() {</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="kw">let</span> format <span class="op">=</span> <span class="st">&#39;yyyy年MM月dd日 HH時mm分ss秒&#39;</span><span class="op">;</span></span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="kw">let</span> dt1 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="kw">let</span> dt1_str <span class="op">=</span> Utilities<span class="op">.</span><span class="fu">formatDate</span>(dt1<span class="op">,</span> <span class="st">&#39;Asia/Tokyo&#39;</span><span class="op">,</span> format)<span class="op">;</span></span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="kw">let</span> dt2 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(dt1<span class="op">.</span><span class="fu">getTime</span>())<span class="op">;</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>  dt2<span class="op">.</span><span class="fu">setDate</span>(dt1<span class="op">.</span><span class="fu">getDate</span>() <span class="op">+</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">// 1日後</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="kw">let</span> dt2_str <span class="op">=</span> Utilities<span class="op">.</span><span class="fu">formatDate</span>(dt2<span class="op">,</span> <span class="st">&#39;Asia/Tokyo&#39;</span><span class="op">,</span> format)<span class="op">;</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`</span><span class="sc">${</span>dt1_str<span class="sc">}</span><span class="vs"> の1日後は </span><span class="sc">${</span>dt2_str<span class="sc">}</span><span class="vs"> です。`</span>)<span class="op">;</span></span>
<span id="cb11-12"><a href="#cb11-12"></a></span>
<span id="cb11-13"><a href="#cb11-13"></a>  <span class="kw">let</span> dt3 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(dt1<span class="op">.</span><span class="fu">getTime</span>())<span class="op">;</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>  dt3<span class="op">.</span><span class="fu">setHours</span>(dt1<span class="op">.</span><span class="fu">getHours</span>() <span class="op">-</span> <span class="dv">23</span>)<span class="op">;</span> <span class="co">// 23時間前</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>  <span class="kw">let</span> dt3_str <span class="op">=</span> Utilities<span class="op">.</span><span class="fu">formatDate</span>(dt3<span class="op">,</span> <span class="st">&#39;Asia/Tokyo&#39;</span><span class="op">,</span> format)<span class="op">;</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`</span><span class="sc">${</span>dt1_str<span class="sc">}</span><span class="vs"> の23時間前は </span><span class="sc">${</span>dt3_str<span class="sc">}</span><span class="vs"> です。`</span>)<span class="op">;</span></span>
<span id="cb11-17"><a href="#cb11-17"></a>}</span></code></pre></div>
      <div class="sourceCode" id="cb12" data-caption="指定時刻までの残り時間の計算1"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">function</span> <span class="fu">calcDatetime_02</span>() {</span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="kw">let</span> dt1 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="st">&#39;2023/12/31 00:00:00&#39;</span>)<span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="kw">let</span> dt2 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="kw">let</span> hours <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((dt1 <span class="op">-</span> dt2) <span class="op">/</span> (<span class="dv">1000</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">60</span>))<span class="op">;</span> <span class="co">// ミリ秒を時間に変換</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`あと </span><span class="sc">${</span>hours<span class="sc">}</span><span class="vs"> 時間`</span>)<span class="op">;</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>}</span></code></pre></div>
      <div class="sourceCode" id="cb13" data-caption="指定時刻までの残り時間の計算2"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">function</span> <span class="fu">calcDatetime_03</span>() {</span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="kw">let</span> dt1 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>(<span class="st">&#39;2023/12/31 00:00:00&#39;</span>)<span class="op">;</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="kw">let</span> dt2 <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="kw">let</span> ts <span class="op">=</span> dt1 <span class="op">-</span> dt2<span class="op">;</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="kw">let</span> hours <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(ts <span class="op">/</span> (<span class="dv">1000</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">60</span>))<span class="op">;</span> <span class="co">// ミリ秒を時間に変換して整数部分を取得</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="kw">let</span> minutes <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>((ts <span class="op">%</span> (<span class="dv">1000</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">60</span>)) <span class="op">/</span> (<span class="dv">1000</span> <span class="op">*</span> <span class="dv">60</span>))<span class="op">;</span> <span class="co">// 残りのミリ秒を分に変換</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`あと </span><span class="sc">${</span>hours<span class="sc">}</span><span class="vs"> 時間 </span><span class="sc">${</span>minutes<span class="sc">}</span><span class="vs"> 分`</span>)<span class="op">;</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>}</span></code></pre></div>
      <h1 data-number="8" id="urlパラメータの処理"><span class="header-section-number">8</span>
      URLパラメータの処理</h1>
      <h2 data-number="8.1" id="準備と復習"><span class="header-section-number">8.1</span>
      準備と復習</h2>
      <p>HTTP GET をトリガーとする関数 <code>doGet</code> を定義し、<a
      href="lecture03.html#http-get-をトリガーとする関数の実行">デプロイ設定</a>を行ない、ウェブブラウザからアクセスして正常に動作することを確認してください。</p>
      <div class="sourceCode" id="cb14" data-caption="doGet"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">function</span> <span class="fu">doGet</span>(e) {</span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="kw">let</span> msg1 <span class="op">=</span> <span class="vs">`ランク「</span><span class="sc">${</span><span class="fu">getCard_01</span>()<span class="sc">}</span><span class="vs">」のカードをゲットしました`</span><span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="kw">let</span> msg2 <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(e<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="st">&#39;  &#39;</span>)<span class="op">;</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="kw">let</span> msg <span class="op">=</span> msg1 <span class="op">+</span> <span class="st">&#39;</span><span class="sc">\n\n</span><span class="st">&#39;</span> <span class="op">+</span> <span class="st">&#39;e = &#39;</span> <span class="op">+</span> msg2<span class="op">;</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(msg)<span class="op">;</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="cf">return</span> ContentService<span class="op">.</span><span class="fu">createTextOutput</span>(msg)<span class="op">;</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>}</span></code></pre></div>
      <p>次のような結果を得られるはずです。</p>
      <figure>
      <img src="figs/05/api_01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <ul>
      <li>URLの末尾に <code>?n=99</code>
      をつけてアクセスして、レスポンスがどのように変化するか確認してください。</li>
      <li>URLの末尾に <code>?type=normal</code>
      をつけてアクセスして、レスポンスがどのように変化するか確認してください。</li>
      <li>URLの末尾に <code>?type=normal&amp;n=99</code>
      をつけてアクセスして、レスポンスがどのように変化するか確認してください。</li>
      </ul>
      <h2 data-number="8.2" id="python-からのウェブapiの実行テスト"><span
      class="header-section-number">8.2</span> Python からのウェブAPIの実行テスト</h2>
      <p>GoogleColab でノートブックを作成し、Pythonプログラムから上記の ウェブAPI
      から応答が得られることを確認してください。</p>
      <div class="sourceCode" id="cb15" data-caption="doGetのテスト"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="op">%</span>reset <span class="op">-</span>f</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="im">import</span> requests</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a>base_URL <span class="op">=</span> <span class="st">&#39;https://script.google.com/macros/s/&#39;</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>deploy_ID <span class="op">=</span> <span class="st">&#39;AKfyxxxxxxxxxxxxxxxxxxxxxxxxxxx&#39;</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>URL <span class="op">=</span> base_URL <span class="op">+</span> deploy_ID <span class="op">+</span> <span class="st">&#39;/exec&#39;</span></span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a>res <span class="op">=</span> requests.get(URL)</span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="bu">print</span>(res.text)</span></code></pre></div>
      <h2 data-number="8.3" id="urlパラメータに応じた処理の分岐"><span
      class="header-section-number">8.3</span> URLパラメータに応じた処理の分岐</h2>
      <p><code>doGet</code> 関数では <strong>URLパラメータ</strong>
      を解析して処理を分岐させることができます。パラメータはアドレスの末尾に
      <code>?type=normal&amp;n=10</code>
      のような形式で与えます。なお、同名の関数が存在していると、予期せぬエラーを引き起こすので注意してください
      (既存の <code>doGet</code> はコメントアウトして、以下を追加してください)。</p>
      <div class="sourceCode" id="cb16" data-caption="URLパラメータの処理"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">function</span> <span class="fu">doGet</span>(e) {</span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="cf">if</span> (e <span class="op">==</span> <span class="kw">undefined</span>) {</span>
<span id="cb16-4"><a href="#cb16-4"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">warn</span>(<span class="st">&#39;この関数は HTTP GET から実行してください。&#39;</span>)<span class="op">;</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="cf">return</span><span class="op">;</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>  }</span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a>  <span class="kw">let</span> type <span class="op">=</span> e<span class="op">.</span><span class="at">parameter</span><span class="op">.</span><span class="at">type</span><span class="op">;</span></span>
<span id="cb16-9"><a href="#cb16-9"></a>  <span class="kw">let</span> n <span class="op">=</span> <span class="bu">Number</span>(e<span class="op">.</span><span class="at">parameter</span><span class="op">.</span><span class="at">n</span>)<span class="op">;</span> <span class="co">// 文字列-&gt;数値</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>  <span class="kw">let</span> msg <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>  <span class="cf">switch</span> (type) {</span>
<span id="cb16-12"><a href="#cb16-12"></a>    <span class="cf">case</span> <span class="st">&#39;normal&#39;</span><span class="op">:</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>      msg <span class="op">=</span> <span class="vs">`ノーマルガチャを </span><span class="sc">${</span>n<span class="sc">}</span><span class="vs"> 回まわします`</span><span class="op">;</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>      <span class="cf">break</span><span class="op">;</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>    <span class="cf">case</span> <span class="st">&#39;special&#39;</span><span class="op">:</span></span>
<span id="cb16-16"><a href="#cb16-16"></a>      msg <span class="op">=</span> <span class="vs">`スペシャルガチャを </span><span class="sc">${</span>n<span class="sc">}</span><span class="vs"> 回まわします`</span><span class="op">;</span></span>
<span id="cb16-17"><a href="#cb16-17"></a>      <span class="cf">break</span><span class="op">;</span></span>
<span id="cb16-18"><a href="#cb16-18"></a>    <span class="cf">default</span><span class="op">:</span></span>
<span id="cb16-19"><a href="#cb16-19"></a>      msg <span class="op">=</span> <span class="vs">`不正なパラメータです`</span><span class="op">;</span></span>
<span id="cb16-20"><a href="#cb16-20"></a>      <span class="cf">break</span><span class="op">;</span></span>
<span id="cb16-21"><a href="#cb16-21"></a>  }</span>
<span id="cb16-22"><a href="#cb16-22"></a>  <span class="cf">return</span> ContentService<span class="op">.</span><span class="fu">createTextOutput</span>(msg)<span class="op">;</span></span>
<span id="cb16-23"><a href="#cb16-23"></a>}</span></code></pre></div>
      <p><strong>演習</strong> :
      上記のプログラムを理解し、実際にガチャ内容を含めてレスポンスするような機能を実装してください。</p>
      <h2 data-number="8.4" id="json形式のレスポンス"><span class="header-section-number">8.4</span>
      JSON形式のレスポンス</h2>
      <p>ウェブAPI のレスポンス形式としては JSON : JavaScript Object Notation
      が広く採用されています。ウェブAPI を呼び出す Python や JavaScript
      においても、JSON形式でレスポンスを受けとれると、その後の処理が容易になります。</p>
      <div class="sourceCode" id="cb17" data-caption="JSON形式のレスポンス"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">function</span> <span class="fu">doGet</span>(e) {</span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="kw">let</span> n <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="kw">let</span> tmp <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="cf">for</span>(<span class="kw">let</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>n<span class="op">;</span>i<span class="op">++</span>){</span>
<span id="cb17-5"><a href="#cb17-5"></a>    tmp[i]<span class="op">=</span><span class="fu">getCard_01</span>()<span class="op">;</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>  }</span>
<span id="cb17-7"><a href="#cb17-7"></a>  <span class="kw">let</span> res <span class="op">=</span> { <span class="dt">code</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">msg</span><span class="op">:</span> <span class="vs">`ガチャを </span><span class="sc">${</span>n<span class="sc">}</span><span class="vs"> 回 (</span><span class="sc">${</span>n<span class="op">*</span><span class="dv">300</span><span class="sc">}</span><span class="vs">円分) 実行しました。`</span><span class="op">,</span> <span class="dt">cards</span><span class="op">:</span> tmp }<span class="op">;</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="kw">let</span> jsonStr <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(res)<span class="op">;</span> <span class="co">// JSON文字列に変換</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(jsonStr)<span class="op">;</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="cf">return</span> ContentService<span class="op">.</span><span class="fu">createTextOutput</span>(jsonStr)<span class="op">;</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>}</span></code></pre></div>
      <div class="sourceCode" id="cb18"
      data-caption="GoogleColab.で実装 (JSON型のレスポンスの処理)"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="op">%</span>reset <span class="op">-</span>f</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="im">import</span> json       <span class="co"># 要インポート</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="im">import</span> requests</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a>base_URL <span class="op">=</span> <span class="st">&#39;https://script.google.com/macros/s/&#39;</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>deploy_ID <span class="op">=</span> <span class="st">&#39;AKfycxxxxxxxxxxxxxxxx&#39;</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>URL <span class="op">=</span> base_URL <span class="op">+</span> deploy_ID <span class="op">+</span> <span class="st">&#39;/exec&#39;</span></span>
<span id="cb18-8"><a href="#cb18-8"></a></span>
<span id="cb18-9"><a href="#cb18-9"></a>res1 <span class="op">=</span> requests.get(URL).text</span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="bu">print</span>(<span class="ss">f&#39;tyep(res1) =&gt; </span><span class="sc">{</span><span class="bu">type</span>(res1)<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="bu">print</span>(<span class="ss">f&#39;res =&gt; </span><span class="sc">{</span>res1<span class="sc">}</span><span class="ss">&#39;</span>,end<span class="op">=</span><span class="st">&#39;</span><span class="ch">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb18-12"><a href="#cb18-12"></a></span>
<span id="cb18-13"><a href="#cb18-13"></a>res2 <span class="op">=</span> json.loads(res1) <span class="co"># JSONのデシリアライズ</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="bu">print</span>(<span class="ss">f&#39;tyep(res2) =&gt; </span><span class="sc">{</span><span class="bu">type</span>(res2)<span class="sc">}</span><span class="ss">&#39;</span>) <span class="co"># 辞書型</span></span>
<span id="cb18-15"><a href="#cb18-15"></a></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="bu">print</span>(<span class="bu">type</span>(res2[<span class="st">&#39;code&#39;</span>]))   <span class="co"># 整数型</span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="bu">print</span>(<span class="bu">type</span>(res2[<span class="st">&#39;msg&#39;</span>]))    <span class="co"># 文字列型</span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="bu">print</span>(<span class="bu">type</span>(res2[<span class="st">&#39;cards&#39;</span>]))  <span class="co"># リスト型</span></span></code></pre></div>
      <h1 data-number="9" id="html-のレスポンス"><span class="header-section-number">9</span> HTML
      のレスポンス</h1>
      <p>学校標準のGoogleアカウントで GoogleWorkspace
      にログインして、Googleスプレッドシートを新規作成して、ファイル名を
      <code>GasApp03_NN_Name</code> に変更してください。出席番号「3番」の「高専太郎」の場合は
      <code>GasApp03_03_高専太郎</code> となるはずです。</p>
      <p>ここでは、HTMLをレスポンスするような処理を考えていきます。</p>
      <h2 data-number="9.1" id="サンプル"><span class="header-section-number">9.1</span>
      サンプル</h2>
      <p><code>コード.gs</code>、<code>css.html</code>、<code>script.html</code>、<code>app.html</code>
      を、以下のように構成します。</p>
      <figure>
      <img src="figs/05/codes.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <div class="sourceCode" id="cb19" data-caption="コード.gs"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">function</span> <span class="fu">writeMsg</span>() {</span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;こんにちは&quot;</span>)<span class="op">;</span>  </span>
<span id="cb19-3"><a href="#cb19-3"></a>}</span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="kw">function</span> <span class="fu">getGreeting</span>() {</span>
<span id="cb19-6"><a href="#cb19-6"></a>  arr <span class="op">=</span> [<span class="st">&#39;01-おはよう&#39;</span><span class="op">,</span><span class="st">&#39;02-こんにちは&#39;</span><span class="op">,</span><span class="st">&#39;03-こんばんは&#39;</span><span class="op">,</span><span class="st">&#39;04-ども&#39;</span>]<span class="op">;</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>  <span class="kw">let</span> i <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> arr<span class="op">.</span><span class="at">length</span>)<span class="op">;</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(arr[i])<span class="op">;</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>  <span class="cf">return</span> arr[i]<span class="op">;</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>}</span>
<span id="cb19-11"><a href="#cb19-11"></a></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="kw">var</span> userName<span class="op">;</span> <span class="co">// グローバルスコープ (グローバル変数)</span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="kw">function</span> <span class="fu">doGet</span>(e){</span>
<span id="cb19-14"><a href="#cb19-14"></a>  userName <span class="op">=</span> <span class="st">&#39;山田&#39;</span><span class="op">;</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>  <span class="cf">return</span> HtmlService<span class="op">.</span><span class="fu">createTemplateFromFile</span>(<span class="st">&#39;app&#39;</span>)<span class="op">.</span><span class="fu">evaluate</span>()<span class="op">;</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>}</span></code></pre></div>
      <div class="sourceCode" id="cb20" data-caption="css.html (拡張子に注意)"><pre
      class="sourceCode numberSource html numberLines"><code class="sourceCode html"><span id="cb20-1"><a href="#cb20-1"></a><span class="dt">&lt;</span><span class="kw">style</span><span class="dt">&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  body {</span>
<span id="cb20-3"><a href="#cb20-3"></a>    <span class="kw">background-color</span><span class="ch">:</span> <span class="cn">#fffdee</span><span class="op">;</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>  }</span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="dt">&lt;/</span><span class="kw">style</span><span class="dt">&gt;</span></span></code></pre></div>
      <div class="sourceCode" id="cb21" data-caption="script.html (拡張子に注意)"><pre
      class="sourceCode numberSource html numberLines"><code class="sourceCode html"><span id="cb21-1"><a href="#cb21-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw">function</span> <span class="fu">setMsg</span>(){</span>
<span id="cb21-3"><a href="#cb21-3"></a>  伝言エリア<span class="op">.</span><span class="at">innerText</span> <span class="op">=</span> 入力内容<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>}</span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span></code></pre></div>
      <div class="sourceCode" id="cb22" data-caption="app.html"><pre
      class="sourceCode numberSource html numberLines"><code class="sourceCode html"><span id="cb22-1"><a href="#cb22-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="dt">&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>    <span class="dt">&lt;</span><span class="kw">base</span><span class="ot"> target</span><span class="op">=</span><span class="st">&quot;_top&quot;</span><span class="dt">&gt;</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>    <span class="co">&lt;!-- ▼ css.html を埋め込み ▼ --&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>    <span class="kw">&lt;?</span>!= HtmlService.createHtmlOutputFromFile(&#39;css&#39;).getContent(); <span class="kw">?&gt;</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>  <span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>  <span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb22-9"><a href="#cb22-9"></a></span>
<span id="cb22-10"><a href="#cb22-10"></a>    <span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>伝言板<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>    <span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;</span><span class="kw">&lt;?</span>= getGreeting() <span class="kw">?&gt;</span>、<span class="kw">&lt;?</span>= userName <span class="kw">?&gt;</span>さん<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>    <span class="dt">&lt;</span><span class="kw">p</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;伝言エリア&quot;</span><span class="dt">&gt;</span>伝言はまだありません<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb22-13"><a href="#cb22-13"></a>    </span>
<span id="cb22-14"><a href="#cb22-14"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb22-15"><a href="#cb22-15"></a>      <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;入力内容&quot;</span><span class="dt">&gt;&lt;</span><span class="kw">button</span><span class="ot"> onclick</span><span class="op">=</span><span class="st">&quot;setMsg();&quot;</span><span class="dt">&gt;</span>書き込み<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb22-16"><a href="#cb22-16"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb22-17"><a href="#cb22-17"></a></span>
<span id="cb22-18"><a href="#cb22-18"></a>    <span class="co">&lt;!-- ▼ script.html を埋め込み ▼ --&gt;</span></span>
<span id="cb22-19"><a href="#cb22-19"></a>    <span class="kw">&lt;?</span>!= HtmlService.createHtmlOutputFromFile(&#39;script&#39;).getContent(); <span class="kw">?&gt;</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>    </span>
<span id="cb22-21"><a href="#cb22-21"></a>  <span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb22-22"><a href="#cb22-22"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
      <figure>
      <img src="figs/05/api_02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h1 data-number="10" id="ウェブアプリの構築"><span class="header-section-number">10</span>
      ウェブアプリの構築</h1>
      <p>Googleスプレッドシートを新規作成して、ファイル名を <code>GasApp04_NN_Name</code>
      に変更してください。出席番号「3番」の「高専太郎」の場合は <code>GasApp04_03_高専太郎</code>
      となるはずです。</p>
      <p>サーバクライアント型のウェブアプリについて学んでいきます。</p>
      <figure>
      <img src="figs/05/phone-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>上記のモックアップは、<a href="https://app.shotsnapp.com/">https://app.shotsnapp.com/</a>
      を利用して作成しています。</p>
      <h2 data-number="10.1" id="サーバサイド-バックエンド"><span
      class="header-section-number">10.1</span> サーバサイド (バックエンド)</h2>
      <ol type="1">
      <li>「<strong>GASタブ</strong>」に移動して <code>コード.gs</code>
      に次のプログラムを貼り付け、保存してください。また、<code>helloWorld()</code>
      が正常に機能することを確認してください。</li>
      <li>ウェブアプリとしてデプロイしてください。</li>
      <li>発行されたウェブアプリURLに対して、<strong>次のような HTTP GET リクエスト
      を送信</strong>して、その結果 (ブラウザ上のレスポンスと「<strong>シートタブ</strong>」の内容)
      について確認してください。
      <ul>
      <li>https://script.google.com/macros/s/<strong>xxxx</strong>/exec<strong>?action=a&amp;memo=寝坊で遅刻</strong><br>
      <i class="fa-solid fa-arrow-right"></i>
      <code>{"code":0,"msg":"出勤をシステムに登録しました。","cards":["XX","XX","XX"]}</code></li>
      <li>https://script.google.com/macros/s/<strong>xxxx</strong>/exec<strong>?action=c</strong><br>
      <i class="fa-solid fa-arrow-right"></i>
      <code>{"code":1,"msg":"2024年01月xx日 xx時xx分xx秒「出勤（寝坊で遅刻）」が最新の記録です。","cards":["XX","XX","XX"]}</code></li>
      <li>https://script.google.com/macros/s/<strong>xxxx</strong>/exec<strong>?action=b</strong><br>
      <i class="fa-solid fa-arrow-right"></i>
      <code>{"code":0,"msg":"退勤をシステムに登録しました。","cards":["XX","XX","XX"]}</code></li>
      <li>https://script.google.com/macros/s/<strong>xxxx</strong>/exec<strong>?action=x</strong><br>
      <i class="fa-solid fa-arrow-right"></i>
      <code>{"code":-1,"msg":"actionパラメータが不正な値です。","cards":["XX","XX","XX"]}</code></li>
      <li>https://script.google.com/macros/s/xxxx/exec<br> <i class="fa-solid fa-arrow-right"></i>
      <code>{"code":-1,"msg":"actionパラメータが不正な値です。","cards":["XX","XX","XX"]}</code></li>
      </ul></li>
      <li>プログラムの読解に努めてください。<code>コード.gs</code>
      は、<strong>ここまでに学んだ内容</strong> で構成されています (新規要素はありません)。</li>
      </ol>
      <div class="sourceCode" id="cb23" data-caption="コード.gs"><pre
      class="sourceCode numberSource js numberLines"><code class="sourceCode javascript"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">function</span> <span class="fu">helloWorld</span>() {</span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="kw">let</span> r <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSheet</span>()<span class="op">.</span><span class="fu">getRange</span>(<span class="st">&#39;A1&#39;</span>)<span class="op">;</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  r<span class="op">.</span><span class="fu">setValue</span>(<span class="st">&#39;Hello World!&#39;</span>)<span class="op">;</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&#39;Hello World!&#39;</span>)<span class="op">;</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>}</span>
<span id="cb23-6"><a href="#cb23-6"></a></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="kw">function</span> <span class="fu">getDateTimeString</span>() {</span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="kw">let</span> now <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="kw">let</span> format <span class="op">=</span> <span class="st">&#39;yyyy年MM月dd日 HH時mm分ss秒&#39;</span><span class="op">;</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>  <span class="cf">return</span> Utilities<span class="op">.</span><span class="fu">formatDate</span>(now<span class="op">,</span> <span class="st">&#39;Asia/Tokyo&#39;</span><span class="op">,</span> format)<span class="op">;</span></span>
<span id="cb23-11"><a href="#cb23-11"></a>}</span>
<span id="cb23-12"><a href="#cb23-12"></a></span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="kw">function</span> <span class="fu">writeLog</span>(action<span class="op">,</span> memo) {</span>
<span id="cb23-14"><a href="#cb23-14"></a>  <span class="kw">let</span> st <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSheet</span>()<span class="op">;</span></span>
<span id="cb23-15"><a href="#cb23-15"></a>  st<span class="op">.</span><span class="fu">insertRowBefore</span>(<span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>  <span class="kw">let</span> c <span class="op">=</span> st<span class="op">.</span><span class="fu">getRange</span>(<span class="st">&#39;A2&#39;</span>)</span>
<span id="cb23-17"><a href="#cb23-17"></a>  c<span class="op">.</span><span class="fu">setNumberFormat</span>(<span class="st">&#39;@&#39;</span>)<span class="op">;</span></span>
<span id="cb23-18"><a href="#cb23-18"></a>  c<span class="op">.</span><span class="fu">setValue</span>(<span class="fu">getDateTimeString</span>())<span class="op">;</span></span>
<span id="cb23-19"><a href="#cb23-19"></a></span>
<span id="cb23-20"><a href="#cb23-20"></a>  c <span class="op">=</span> st<span class="op">.</span><span class="fu">getRange</span>(<span class="st">&#39;B2&#39;</span>)<span class="op">;</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>  c<span class="op">.</span><span class="fu">setValue</span>(action)<span class="op">;</span></span>
<span id="cb23-22"><a href="#cb23-22"></a></span>
<span id="cb23-23"><a href="#cb23-23"></a>  <span class="cf">if</span> (memo<span class="op">.</span><span class="at">length</span> <span class="op">!=</span> <span class="dv">0</span>) {</span>
<span id="cb23-24"><a href="#cb23-24"></a>    c <span class="op">=</span> st<span class="op">.</span><span class="fu">getRange</span>(<span class="st">&#39;C2&#39;</span>)<span class="op">;</span></span>
<span id="cb23-25"><a href="#cb23-25"></a>    c<span class="op">.</span><span class="fu">setValue</span>(memo)<span class="op">;</span></span>
<span id="cb23-26"><a href="#cb23-26"></a>  }</span>
<span id="cb23-27"><a href="#cb23-27"></a>}</span>
<span id="cb23-28"><a href="#cb23-28"></a></span>
<span id="cb23-29"><a href="#cb23-29"></a><span class="kw">function</span> <span class="fu">readLatestLog</span>() {</span>
<span id="cb23-30"><a href="#cb23-30"></a>  <span class="kw">let</span> st <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSheet</span>()<span class="op">;</span></span>
<span id="cb23-31"><a href="#cb23-31"></a>  <span class="kw">let</span> d <span class="op">=</span> st<span class="op">.</span><span class="fu">getRange</span>(<span class="st">&#39;A2:C2&#39;</span>)<span class="op">.</span><span class="fu">getValues</span>()<span class="op">;</span></span>
<span id="cb23-32"><a href="#cb23-32"></a>  <span class="kw">let</span> msg <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>d[<span class="dv">0</span>][<span class="dv">0</span>]<span class="sc">}</span><span class="vs">「</span><span class="sc">${</span>d[<span class="dv">0</span>][<span class="dv">1</span>]<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb23-33"><a href="#cb23-33"></a>  <span class="cf">if</span> (d[<span class="dv">0</span>][<span class="dv">2</span>]<span class="op">.</span><span class="at">length</span> <span class="op">!=</span> <span class="dv">0</span>) {</span>
<span id="cb23-34"><a href="#cb23-34"></a>    msg <span class="op">+=</span> <span class="vs">`（</span><span class="sc">${</span>d[<span class="dv">0</span>][<span class="dv">2</span>]<span class="sc">}</span><span class="vs">）」が最新の記録です。`</span><span class="op">;</span></span>
<span id="cb23-35"><a href="#cb23-35"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-36"><a href="#cb23-36"></a>    msg <span class="op">+=</span> <span class="st">&#39;」が直前の記録です。&#39;</span><span class="op">;</span></span>
<span id="cb23-37"><a href="#cb23-37"></a>  }</span>
<span id="cb23-38"><a href="#cb23-38"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(msg)<span class="op">;</span></span>
<span id="cb23-39"><a href="#cb23-39"></a>  <span class="cf">return</span> msg<span class="op">;</span></span>
<span id="cb23-40"><a href="#cb23-40"></a>}</span>
<span id="cb23-41"><a href="#cb23-41"></a></span>
<span id="cb23-42"><a href="#cb23-42"></a><span class="kw">function</span> <span class="fu">doGet</span>(e) {</span>
<span id="cb23-43"><a href="#cb23-43"></a></span>
<span id="cb23-44"><a href="#cb23-44"></a>  <span class="cf">if</span> (e <span class="op">==</span> <span class="kw">undefined</span>) {</span>
<span id="cb23-45"><a href="#cb23-45"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">warn</span>(<span class="st">&#39;この関数は HTTP GET から実行してください。&#39;</span>)<span class="op">;</span></span>
<span id="cb23-46"><a href="#cb23-46"></a>    <span class="cf">return</span><span class="op">;</span></span>
<span id="cb23-47"><a href="#cb23-47"></a>  }</span>
<span id="cb23-48"><a href="#cb23-48"></a></span>
<span id="cb23-49"><a href="#cb23-49"></a>  <span class="kw">let</span> action <span class="op">=</span> e<span class="op">.</span><span class="at">parameter</span><span class="op">.</span><span class="at">action</span><span class="op">;</span></span>
<span id="cb23-50"><a href="#cb23-50"></a>  <span class="kw">let</span> memo <span class="op">=</span> e<span class="op">.</span><span class="at">parameter</span><span class="op">.</span><span class="at">memo</span><span class="op">;</span></span>
<span id="cb23-51"><a href="#cb23-51"></a>  <span class="cf">if</span> (memo <span class="op">==</span> <span class="kw">undefined</span>) {</span>
<span id="cb23-52"><a href="#cb23-52"></a>    memo <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb23-53"><a href="#cb23-53"></a>  }</span>
<span id="cb23-54"><a href="#cb23-54"></a>  <span class="kw">let</span> msg <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></span>
<span id="cb23-55"><a href="#cb23-55"></a>  <span class="kw">let</span> code <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb23-56"><a href="#cb23-56"></a>  <span class="cf">switch</span> (action) {</span>
<span id="cb23-57"><a href="#cb23-57"></a>    <span class="cf">case</span> <span class="st">&#39;a&#39;</span><span class="op">:</span></span>
<span id="cb23-58"><a href="#cb23-58"></a>      <span class="fu">writeLog</span>(<span class="st">&#39;出勤&#39;</span><span class="op">,</span> memo)<span class="op">;</span></span>
<span id="cb23-59"><a href="#cb23-59"></a>      msg <span class="op">=</span> <span class="st">&#39;出勤をシステムに登録しました。&#39;</span></span>
<span id="cb23-60"><a href="#cb23-60"></a>      <span class="cf">break</span><span class="op">;</span></span>
<span id="cb23-61"><a href="#cb23-61"></a>    <span class="cf">case</span> <span class="st">&#39;b&#39;</span><span class="op">:</span></span>
<span id="cb23-62"><a href="#cb23-62"></a>      <span class="fu">writeLog</span>(<span class="st">&#39;退勤&#39;</span><span class="op">,</span> memo)<span class="op">;</span></span>
<span id="cb23-63"><a href="#cb23-63"></a>      msg <span class="op">=</span> <span class="st">&#39;退勤をシステムに登録しました。&#39;</span></span>
<span id="cb23-64"><a href="#cb23-64"></a>      <span class="cf">break</span><span class="op">;</span></span>
<span id="cb23-65"><a href="#cb23-65"></a>    <span class="cf">case</span> <span class="st">&#39;c&#39;</span><span class="op">:</span></span>
<span id="cb23-66"><a href="#cb23-66"></a>      msg <span class="op">=</span> <span class="fu">readLatestLog</span>()<span class="op">;</span></span>
<span id="cb23-67"><a href="#cb23-67"></a>      code <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb23-68"><a href="#cb23-68"></a>      <span class="cf">break</span><span class="op">;</span></span>
<span id="cb23-69"><a href="#cb23-69"></a>    <span class="cf">default</span><span class="op">:</span></span>
<span id="cb23-70"><a href="#cb23-70"></a>      msg <span class="op">=</span> <span class="vs">`actionパラメータが不正な値です。`</span><span class="op">;</span></span>
<span id="cb23-71"><a href="#cb23-71"></a>      code <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb23-72"><a href="#cb23-72"></a>      <span class="cf">break</span><span class="op">;</span></span>
<span id="cb23-73"><a href="#cb23-73"></a>  }</span>
<span id="cb23-74"><a href="#cb23-74"></a></span>
<span id="cb23-75"><a href="#cb23-75"></a>  <span class="kw">let</span> res <span class="op">=</span> { code<span class="op">,</span> msg }<span class="op">;</span></span>
<span id="cb23-76"><a href="#cb23-76"></a>  <span class="kw">let</span> jsonStr <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(res)<span class="op">;</span> <span class="co">// JSON文字列に変換</span></span>
<span id="cb23-77"><a href="#cb23-77"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(jsonStr)<span class="op">;</span></span>
<span id="cb23-78"><a href="#cb23-78"></a>  <span class="cf">return</span> ContentService<span class="op">.</span><span class="fu">createTextOutput</span>(jsonStr)<span class="op">;</span></span>
<span id="cb23-79"><a href="#cb23-79"></a>}</span></code></pre></div>
      <h3 data-number="10.1.1" id="pythonプログラムからのアクセス"><span
      class="header-section-number">10.1.1</span> Pythonプログラムからのアクセス</h3>
      <p>GoogleColab. など、Pythonプログラムから上記ウェブアプリ (ウェブAPI)
      にアクセスして、レスポンス (応答) を得るようなプログラムを作成してください。</p>
      <p>また、<code>json</code> ライブラリを利用し、レスポンスのJSON文字列を「辞書オブジェクト
      (<code>dict</code>型)」に変換 (デコード) して扱うようなプログラムに拡張してください。<a
      href="lecture05.html#json形式のレスポンス">参考</a></p>
      <div class="sourceCode" id="cb24" data-caption="JSONのデコード (参考)"><pre
      class="sourceCode numberSource python numberLines"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="im">import</span> json</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a>json_str <span class="op">=</span> <span class="st">&#39;{&quot;code&quot;:0,&quot;msg&quot;:&quot;出勤をシステムに登録しました。&quot;,&quot;cards&quot;:[&quot;XX&quot;,&quot;XX&quot;,&quot;XX&quot;]}&#39;</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>dict_obj <span class="op">=</span> json.loads(json_str)</span>
<span id="cb24-5"><a href="#cb24-5"></a></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="bu">print</span>(<span class="bu">type</span>(dict_obj))    <span class="co"># =&gt; &lt;class &#39;dict&#39;&gt;</span></span>
<span id="cb24-7"><a href="#cb24-7"></a></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="bu">print</span>(dict_obj[<span class="st">&#39;code&#39;</span>])        <span class="co"># =&gt; 0</span></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="bu">print</span>(<span class="bu">type</span>(dict_obj[<span class="st">&#39;code&#39;</span>]))  <span class="co"># =&gt; &lt;class &#39;int&#39;&gt;</span></span>
<span id="cb24-10"><a href="#cb24-10"></a></span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="bu">print</span>(dict_obj[<span class="st">&#39;msg&#39;</span>])         <span class="co"># =&gt; 出勤をシステムに登録しました。</span></span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="bu">print</span>(<span class="bu">type</span>(dict_obj[<span class="st">&#39;msg&#39;</span>]))   <span class="co"># =&gt; &lt;class &#39;str&#39;&gt;</span></span>
<span id="cb24-13"><a href="#cb24-13"></a></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="bu">print</span>(dict_obj[<span class="st">&#39;cards&#39;</span>])       <span class="co"># =&gt; [&#39;XX&#39;, &#39;XX&#39;, &#39;XX&#39;]</span></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="bu">print</span>(<span class="bu">type</span>(dict_obj[<span class="st">&#39;cards&#39;</span>])) <span class="co"># =&gt; &lt;class &#39;list&#39;&gt;</span></span></code></pre></div>
      <h2 data-number="10.2" id="クライアントサイド-フロントエンド"><span
      class="header-section-number">10.2</span> クライアントサイド (フロントエンド)</h2>
      <p><strong>ローカルPC</strong> (≠GASタブのプロジェクト) に適当なフォルダを作成して
      <code>app.html</code>、<code>style.css</code>
      を新規作成して、下記のコードを貼り付けて保存してください。その際、文字コードが
      <code>UTF-8</code> となるように注意してください。また、そのフォルダに <a
      href="figs/05/app-img.png">app-img.png</a> を配置してください (この画像は「<strong>DALL-E
      3</strong>」により生成したものです)。</p>
      <p><strong>第40行目</strong>の <code>API_ID</code>
      は各自のデプロイにあわせて変更してください。</p>
      <p>ウェブブラウザで <code>app.html</code>
      を開いて動作を確認してください。また、その際、デベロッパーツール (<code>F12</code>)
      も活用してください。コードの詳細は、後ほど口頭で解説しますが、まずは、各自で読み込み、理解に努めてください。</p>
      <div class="sourceCode" id="cb25" data-caption="app.html"><pre
      class="sourceCode numberSource html numberLines"><code class="sourceCode html"><span id="cb25-1"><a href="#cb25-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;ja&quot;</span><span class="dt">&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>    <span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;utf-8&quot;</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>    <span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>WebAppTemplate<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>    <span class="dt">&lt;</span><span class="kw">meta</span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="ot">      name</span><span class="op">=</span><span class="st">&quot;viewport&quot;</span></span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="ot">      content</span><span class="op">=</span><span class="st">&quot;width=device-width, initial-scale=1.0, user-scalable=yes&quot;</span></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="ot">    </span><span class="dt">/&gt;</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>    <span class="dt">&lt;</span><span class="kw">link</span></span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="ot">      rel</span><span class="op">=</span><span class="st">&quot;stylesheet&quot;</span></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="ot">      href</span><span class="op">=</span><span class="st">&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css&quot;</span></span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="ot">    </span><span class="dt">/&gt;</span></span>
<span id="cb25-14"><a href="#cb25-14"></a>    <span class="dt">&lt;</span><span class="kw">link</span></span>
<span id="cb25-15"><a href="#cb25-15"></a><span class="ot">      rel</span><span class="op">=</span><span class="st">&quot;stylesheet&quot;</span></span>
<span id="cb25-16"><a href="#cb25-16"></a><span class="ot">      href</span><span class="op">=</span><span class="st">&quot;https://fonts.googleapis.com/css2?family=Yusei+Magic</span><span class="er">&amp;</span><span class="st">display=swap&quot;</span></span>
<span id="cb25-17"><a href="#cb25-17"></a><span class="ot">    </span><span class="dt">/&gt;</span></span>
<span id="cb25-18"><a href="#cb25-18"></a>    <span class="dt">&lt;</span><span class="kw">link</span><span class="ot"> rel</span><span class="op">=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href</span><span class="op">=</span><span class="st">&quot;main.css&quot;</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb25-19"><a href="#cb25-19"></a>  <span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb25-20"><a href="#cb25-20"></a></span>
<span id="cb25-21"><a href="#cb25-21"></a>  <span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb25-22"><a href="#cb25-22"></a>    <span class="dt">&lt;</span><span class="kw">h1</span><span class="dt">&gt;</span>アプリのタイトル<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb25-23"><a href="#cb25-23"></a>    <span class="dt">&lt;</span><span class="kw">img</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;app-img.png&quot;</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb25-24"><a href="#cb25-24"></a>    <span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;</span>アプリの説明<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb25-25"><a href="#cb25-25"></a></span>
<span id="cb25-26"><a href="#cb25-26"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;InputUiDiv&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;input-ui&quot;</span><span class="dt">&gt;</span></span>
<span id="cb25-27"><a href="#cb25-27"></a>      <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;Button1&quot;</span><span class="dt">&gt;</span>出勤打刻<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb25-28"><a href="#cb25-28"></a>      <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;Button2&quot;</span><span class="dt">&gt;</span>退勤打刻<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb25-29"><a href="#cb25-29"></a>      <span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;Button3&quot;</span><span class="dt">&gt;</span>直前の記録の確認<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb25-30"><a href="#cb25-30"></a>      <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> type</span><span class="op">=</span><span class="st">&quot;text&quot;</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;TextBox&quot;</span><span class="ot"> placeholder</span><span class="op">=</span><span class="st">&quot;Enter memo here.&quot;</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb25-31"><a href="#cb25-31"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb25-32"><a href="#cb25-32"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;IsBusy&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;loader&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb25-33"><a href="#cb25-33"></a>    <span class="dt">&lt;</span><span class="kw">p</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;ResMsg&quot;</span><span class="dt">&gt;</span>ボタンを押下してください。<span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb25-34"><a href="#cb25-34"></a>  <span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb25-35"><a href="#cb25-35"></a></span>
<span id="cb25-36"><a href="#cb25-36"></a>  <span class="dt">&lt;</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb25-37"><a href="#cb25-37"></a>    <span class="bu">window</span><span class="op">.</span><span class="at">onload</span> <span class="op">=</span> <span class="kw">function</span> () {</span>
<span id="cb25-38"><a href="#cb25-38"></a>      <span class="kw">function</span> <span class="fu">$</span>(e) {</span>
<span id="cb25-39"><a href="#cb25-39"></a>        <span class="cf">return</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(e)<span class="op">;</span></span>
<span id="cb25-40"><a href="#cb25-40"></a>      }</span>
<span id="cb25-41"><a href="#cb25-41"></a>      <span class="kw">const</span> API_ID <span class="op">=</span> <span class="st">&quot;AK...&quot;</span><span class="op">;</span></span>
<span id="cb25-42"><a href="#cb25-42"></a>      <span class="kw">const</span> API_URL <span class="op">=</span> <span class="vs">`https://script.google.com/macros/s/</span><span class="sc">${</span>API_ID<span class="sc">}</span><span class="vs">/exec`</span><span class="op">;</span></span>
<span id="cb25-43"><a href="#cb25-43"></a></span>
<span id="cb25-44"><a href="#cb25-44"></a>      <span class="kw">function</span> <span class="fu">GetData</span>(action) {</span>
<span id="cb25-45"><a href="#cb25-45"></a>        <span class="fu">$</span>(<span class="st">&quot;#ResMsg&quot;</span>)<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">&quot;...処理中...&quot;</span><span class="op">;</span></span>
<span id="cb25-46"><a href="#cb25-46"></a>        <span class="fu">$</span>(<span class="st">&quot;#IsBusy&quot;</span>)<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">&quot;flex&quot;</span><span class="op">;</span></span>
<span id="cb25-47"><a href="#cb25-47"></a>        <span class="fu">$</span>(<span class="st">&quot;#InputUiDiv&quot;</span>)<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">&quot;none&quot;</span><span class="op">;</span></span>
<span id="cb25-48"><a href="#cb25-48"></a></span>
<span id="cb25-49"><a href="#cb25-49"></a>        <span class="kw">let</span> URL <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">?action=</span><span class="sc">${</span>action<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb25-50"><a href="#cb25-50"></a>        <span class="kw">let</span> memo <span class="op">=</span> <span class="fu">$</span>(<span class="st">&quot;#TextBox&quot;</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb25-51"><a href="#cb25-51"></a>        <span class="cf">if</span> (memo<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb25-52"><a href="#cb25-52"></a>          <span class="kw">let</span> encodedMemo <span class="op">=</span> <span class="pp">encodeURIComponent</span>(memo)<span class="op">;</span></span>
<span id="cb25-53"><a href="#cb25-53"></a>          URL <span class="op">+=</span> <span class="vs">`&amp;memo=</span><span class="sc">${</span>encodedMemo<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb25-54"><a href="#cb25-54"></a>          <span class="fu">$</span>(<span class="st">&quot;#TextBox&quot;</span>)<span class="op">.</span><span class="at">value</span> <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb25-55"><a href="#cb25-55"></a>        }</span>
<span id="cb25-56"><a href="#cb25-56"></a>        <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(URL)<span class="op">;</span></span>
<span id="cb25-57"><a href="#cb25-57"></a>        <span class="fu">fetch</span>(URL<span class="op">,</span> { <span class="dt">method</span><span class="op">:</span> <span class="st">&quot;GET&quot;</span> })</span>
<span id="cb25-58"><a href="#cb25-58"></a>          <span class="op">.</span><span class="fu">then</span>((res) <span class="kw">=&gt;</span> res<span class="op">.</span><span class="fu">text</span>())</span>
<span id="cb25-59"><a href="#cb25-59"></a>          <span class="op">.</span><span class="fu">then</span>((res) <span class="kw">=&gt;</span> {</span>
<span id="cb25-60"><a href="#cb25-60"></a>            <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(res)<span class="op">;</span></span>
<span id="cb25-61"><a href="#cb25-61"></a>            <span class="kw">let</span> obj <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">parse</span>(res)<span class="op">;</span></span>
<span id="cb25-62"><a href="#cb25-62"></a>            <span class="fu">$</span>(<span class="st">&quot;#ResMsg&quot;</span>)<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="vs">`</span><span class="sc">${</span>obj<span class="op">.</span><span class="at">msg</span><span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb25-63"><a href="#cb25-63"></a>            <span class="fu">$</span>(<span class="st">&quot;#IsBusy&quot;</span>)<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">&quot;none&quot;</span><span class="op">;</span></span>
<span id="cb25-64"><a href="#cb25-64"></a>            <span class="fu">$</span>(<span class="st">&quot;#InputUiDiv&quot;</span>)<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">display</span> <span class="op">=</span> <span class="st">&quot;flex&quot;</span><span class="op">;</span></span>
<span id="cb25-65"><a href="#cb25-65"></a>          })<span class="op">;</span></span>
<span id="cb25-66"><a href="#cb25-66"></a>      }</span>
<span id="cb25-67"><a href="#cb25-67"></a></span>
<span id="cb25-68"><a href="#cb25-68"></a>      <span class="fu">$</span>(<span class="st">&quot;#Button1&quot;</span>)<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> GetData<span class="op">.</span><span class="fu">bind</span>(<span class="kw">null</span><span class="op">,</span> <span class="st">&quot;a&quot;</span>)<span class="op">;</span></span>
<span id="cb25-69"><a href="#cb25-69"></a>      <span class="fu">$</span>(<span class="st">&quot;#Button2&quot;</span>)<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> GetData<span class="op">.</span><span class="fu">bind</span>(<span class="kw">null</span><span class="op">,</span> <span class="st">&quot;b&quot;</span>)<span class="op">;</span></span>
<span id="cb25-70"><a href="#cb25-70"></a>      <span class="fu">$</span>(<span class="st">&quot;#Button3&quot;</span>)<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> GetData<span class="op">.</span><span class="fu">bind</span>(<span class="kw">null</span><span class="op">,</span> <span class="st">&quot;c&quot;</span>)<span class="op">;</span></span>
<span id="cb25-71"><a href="#cb25-71"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;JSプログラムの読込み完了&quot;</span>)<span class="op">;</span></span>
<span id="cb25-72"><a href="#cb25-72"></a>    }<span class="op">;</span></span>
<span id="cb25-73"><a href="#cb25-73"></a>  <span class="dt">&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb25-74"><a href="#cb25-74"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
      <div class="sourceCode" id="cb26" data-caption="main.css"><pre
      class="sourceCode numberSource css numberLines"><code class="sourceCode css"><span id="cb26-1"><a href="#cb26-1"></a>html {</span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="kw">-ms-text-size-adjust</span><span class="ch">:</span> <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="kw">-webkit-text-size-adjust</span><span class="ch">:</span> <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="kw">font-family</span><span class="ch">:</span> <span class="st">&quot;Yusei Magic&quot;</span><span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>}</span>
<span id="cb26-6"><a href="#cb26-6"></a></span>
<span id="cb26-7"><a href="#cb26-7"></a>body {</span>
<span id="cb26-8"><a href="#cb26-8"></a>  <span class="kw">line-height</span><span class="ch">:</span> <span class="dv">1.5</span><span class="op">;</span></span>
<span id="cb26-9"><a href="#cb26-9"></a>  word-wrap<span class="ch">:</span> <span class="dv">break-word</span><span class="op">;</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>  <span class="kw">box-sizing</span><span class="ch">:</span> <span class="dv">border-box</span><span class="op">;</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>  <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">980</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-12"><a href="#cb26-12"></a>  <span class="kw">margin</span><span class="ch">:</span> <span class="dv">2</span><span class="dt">em</span> <span class="bu">auto</span><span class="op">;</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>  <span class="kw">padding</span><span class="ch">:</span> <span class="dv">0</span><span class="dt">px</span> <span class="dv">50</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-14"><a href="#cb26-14"></a>  <span class="kw">text-align</span><span class="ch">:</span> <span class="dv">center</span><span class="op">;</span></span>
<span id="cb26-15"><a href="#cb26-15"></a>}</span>
<span id="cb26-16"><a href="#cb26-16"></a></span>
<span id="cb26-17"><a href="#cb26-17"></a>p {</span>
<span id="cb26-18"><a href="#cb26-18"></a>  <span class="kw">font-size</span><span class="ch">:</span> <span class="dv">1.3</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb26-19"><a href="#cb26-19"></a>  <span class="kw">margin</span><span class="ch">:</span> <span class="dv">0.8</span><span class="dt">rem</span> <span class="dv">0</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-20"><a href="#cb26-20"></a>}</span>
<span id="cb26-21"><a href="#cb26-21"></a></span>
<span id="cb26-22"><a href="#cb26-22"></a><span class="im">@media</span> <span class="fu">(</span><span class="kw">max-width</span><span class="ch">:</span> <span class="dv">767</span><span class="dt">px</span><span class="fu">)</span> {</span>
<span id="cb26-23"><a href="#cb26-23"></a>  body {</span>
<span id="cb26-24"><a href="#cb26-24"></a>    <span class="kw">padding-left</span><span class="ch">:</span> <span class="dv">15</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-25"><a href="#cb26-25"></a>    <span class="kw">padding-right</span><span class="ch">:</span> <span class="dv">15</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-26"><a href="#cb26-26"></a>  }</span>
<span id="cb26-27"><a href="#cb26-27"></a>}</span>
<span id="cb26-28"><a href="#cb26-28"></a></span>
<span id="cb26-29"><a href="#cb26-29"></a>h1 {</span>
<span id="cb26-30"><a href="#cb26-30"></a>  <span class="kw">font-size</span><span class="ch">:</span> <span class="dv">2</span><span class="dt">rem</span><span class="op">;</span></span>
<span id="cb26-31"><a href="#cb26-31"></a>}</span>
<span id="cb26-32"><a href="#cb26-32"></a></span>
<span id="cb26-33"><a href="#cb26-33"></a>img {</span>
<span id="cb26-34"><a href="#cb26-34"></a>  <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb26-35"><a href="#cb26-35"></a>  <span class="kw">height</span><span class="ch">:</span> <span class="bu">auto</span><span class="op">;</span></span>
<span id="cb26-36"><a href="#cb26-36"></a>  <span class="kw">cursor</span><span class="ch">:</span> <span class="dv">pointer</span><span class="op">;</span></span>
<span id="cb26-37"><a href="#cb26-37"></a>  <span class="kw">pointer-events</span><span class="ch">:</span> <span class="dv">none</span><span class="op">;</span></span>
<span id="cb26-38"><a href="#cb26-38"></a>  <span class="kw">box-shadow</span><span class="ch">:</span> <span class="fu">rgba(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0.35</span><span class="fu">)</span> <span class="dv">0</span><span class="dt">px</span> <span class="dv">5</span><span class="dt">px</span> <span class="dv">15</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-39"><a href="#cb26-39"></a>  <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-40"><a href="#cb26-40"></a>}</span>
<span id="cb26-41"><a href="#cb26-41"></a></span>
<span id="cb26-42"><a href="#cb26-42"></a>div<span class="fu">.input-ui</span> {</span>
<span id="cb26-43"><a href="#cb26-43"></a>  <span class="kw">width</span><span class="ch">:</span> <span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="co">/* 親コンテナの幅を100%に設定 */</span></span>
<span id="cb26-44"><a href="#cb26-44"></a>  <span class="kw">display</span><span class="ch">:</span> <span class="dv">flex</span><span class="op">;</span> <span class="co">/* Flexboxを使用して要素を配置 */</span></span>
<span id="cb26-45"><a href="#cb26-45"></a>  <span class="kw">flex-direction</span><span class="ch">:</span> <span class="dv">column</span><span class="op">;</span> <span class="co">/* 子要素を縦方向に並べる */</span></span>
<span id="cb26-46"><a href="#cb26-46"></a>  <span class="kw">align-items</span><span class="ch">:</span> <span class="dv">center</span><span class="op">;</span> <span class="co">/* 子要素を中央に配置 */</span></span>
<span id="cb26-47"><a href="#cb26-47"></a>}</span>
<span id="cb26-48"><a href="#cb26-48"></a></span>
<span id="cb26-49"><a href="#cb26-49"></a>button {</span>
<span id="cb26-50"><a href="#cb26-50"></a>  <span class="kw">width</span><span class="ch">:</span> <span class="dv">100</span><span class="dt">%</span><span class="op">;</span> <span class="co">/* ボタンの幅を親コンテナの90%に設定 */</span></span>
<span id="cb26-51"><a href="#cb26-51"></a>  <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">400</span><span class="dt">px</span><span class="op">;</span> <span class="co">/* ボタンの最大幅を400pxに設定 */</span></span>
<span id="cb26-52"><a href="#cb26-52"></a>  <span class="kw">margin</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span> <span class="dv">0</span><span class="op">;</span> <span class="co">/* 上下のマージンを設定 */</span></span>
<span id="cb26-53"><a href="#cb26-53"></a>  <span class="kw">padding</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span> <span class="dv">20</span><span class="dt">px</span><span class="op">;</span> <span class="co">/* パディングを設定 */</span></span>
<span id="cb26-54"><a href="#cb26-54"></a>  <span class="kw">border</span><span class="ch">:</span> <span class="dv">none</span><span class="op">;</span> <span class="co">/* ボーダーを消す */</span></span>
<span id="cb26-55"><a href="#cb26-55"></a>  <span class="kw">background-color</span><span class="ch">:</span> <span class="cn">#007bff</span><span class="op">;</span> <span class="co">/* 青色系の背景色 */</span></span>
<span id="cb26-56"><a href="#cb26-56"></a>  <span class="kw">color</span><span class="ch">:</span> <span class="cn">white</span><span class="op">;</span> <span class="co">/* 文字色を白に設定 */</span></span>
<span id="cb26-57"><a href="#cb26-57"></a>  <span class="kw">font-size</span><span class="ch">:</span> <span class="dv">16</span><span class="dt">px</span><span class="op">;</span> <span class="co">/* フォントサイズを設定 */</span></span>
<span id="cb26-58"><a href="#cb26-58"></a>  <span class="kw">cursor</span><span class="ch">:</span> <span class="dv">pointer</span><span class="op">;</span> <span class="co">/* カーソルをポインタに設定 */</span></span>
<span id="cb26-59"><a href="#cb26-59"></a>  <span class="kw">transition</span><span class="ch">:</span> <span class="dv">background-color 0.5</span><span class="dt">s</span><span class="op">;</span> <span class="co">/* 背景色の変化をアニメーション化 */</span></span>
<span id="cb26-60"><a href="#cb26-60"></a>  <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-61"><a href="#cb26-61"></a>  <span class="kw">font-family</span><span class="ch">:</span> <span class="st">&quot;Yusei Magic&quot;</span><span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span></span>
<span id="cb26-62"><a href="#cb26-62"></a>}</span>
<span id="cb26-63"><a href="#cb26-63"></a></span>
<span id="cb26-64"><a href="#cb26-64"></a>button<span class="in">:hover</span> {</span>
<span id="cb26-65"><a href="#cb26-65"></a>  <span class="kw">background-color</span><span class="ch">:</span> <span class="cn">#0056b3</span><span class="op">;</span> <span class="co">/* ホバー時の背景色を変更 */</span></span>
<span id="cb26-66"><a href="#cb26-66"></a>}</span>
<span id="cb26-67"><a href="#cb26-67"></a></span>
<span id="cb26-68"><a href="#cb26-68"></a>input {</span>
<span id="cb26-69"><a href="#cb26-69"></a>  <span class="kw">width</span><span class="ch">:</span> <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb26-70"><a href="#cb26-70"></a>  <span class="kw">max-width</span><span class="ch">:</span> <span class="dv">400</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-71"><a href="#cb26-71"></a>  <span class="kw">margin</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb26-72"><a href="#cb26-72"></a>  <span class="kw">padding</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-73"><a href="#cb26-73"></a>  <span class="kw">border</span><span class="ch">:</span> <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">#ccc</span><span class="op">;</span></span>
<span id="cb26-74"><a href="#cb26-74"></a>  <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">5</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-75"><a href="#cb26-75"></a>  <span class="kw">box-sizing</span><span class="ch">:</span> <span class="dv">border-box</span><span class="op">;</span></span>
<span id="cb26-76"><a href="#cb26-76"></a>}</span>
<span id="cb26-77"><a href="#cb26-77"></a></span>
<span id="cb26-78"><a href="#cb26-78"></a><span class="co">/* https://projects.lukehaas.me/css-loaders/ */</span></span>
<span id="cb26-79"><a href="#cb26-79"></a></span>
<span id="cb26-80"><a href="#cb26-80"></a>div<span class="fu">.loader</span> {</span>
<span id="cb26-81"><a href="#cb26-81"></a>  <span class="kw">display</span><span class="ch">:</span> <span class="dv">none</span><span class="op">;</span></span>
<span id="cb26-82"><a href="#cb26-82"></a>}</span>
<span id="cb26-83"><a href="#cb26-83"></a></span>
<span id="cb26-84"><a href="#cb26-84"></a><span class="fu">.loader</span><span class="op">,</span></span>
<span id="cb26-85"><a href="#cb26-85"></a><span class="fu">.loader</span><span class="in">:before</span><span class="op">,</span></span>
<span id="cb26-86"><a href="#cb26-86"></a><span class="fu">.loader</span><span class="in">:after</span> {</span>
<span id="cb26-87"><a href="#cb26-87"></a>  <span class="kw">border-radius</span><span class="ch">:</span> <span class="dv">50</span><span class="dt">%</span><span class="op">;</span></span>
<span id="cb26-88"><a href="#cb26-88"></a>  <span class="kw">width</span><span class="ch">:</span> <span class="dv">2.5</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb26-89"><a href="#cb26-89"></a>  <span class="kw">height</span><span class="ch">:</span> <span class="dv">2.5</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb26-90"><a href="#cb26-90"></a>  <span class="kw">-webkit-animation-fill-mode</span><span class="ch">:</span> <span class="dv">both</span><span class="op">;</span></span>
<span id="cb26-91"><a href="#cb26-91"></a>  <span class="kw">animation-fill-mode</span><span class="ch">:</span> <span class="dv">both</span><span class="op">;</span></span>
<span id="cb26-92"><a href="#cb26-92"></a>  <span class="kw">-webkit-animation</span><span class="ch">:</span> <span class="dv">load7 1.8</span><span class="dt">s</span> <span class="dv">infinite</span> <span class="dv">ease-in-out</span><span class="op">;</span></span>
<span id="cb26-93"><a href="#cb26-93"></a>  <span class="kw">animation</span><span class="ch">:</span> <span class="dv">load7 1.8</span><span class="dt">s</span> <span class="dv">infinite</span> <span class="dv">ease-in-out</span><span class="op">;</span></span>
<span id="cb26-94"><a href="#cb26-94"></a>}</span>
<span id="cb26-95"><a href="#cb26-95"></a><span class="fu">.loader</span> {</span>
<span id="cb26-96"><a href="#cb26-96"></a>  <span class="kw">color</span><span class="ch">:</span> <span class="cn">#007bff</span><span class="op">;</span></span>
<span id="cb26-97"><a href="#cb26-97"></a>  <span class="kw">font-size</span><span class="ch">:</span> <span class="dv">10</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb26-98"><a href="#cb26-98"></a>  <span class="kw">margin</span><span class="ch">:</span> <span class="dv">-20</span><span class="dt">px</span> <span class="bu">auto</span> <span class="dv">40</span><span class="dt">px</span> <span class="bu">auto</span><span class="op">;</span></span>
<span id="cb26-99"><a href="#cb26-99"></a>  <span class="kw">position</span><span class="ch">:</span> <span class="dv">relative</span><span class="op">;</span></span>
<span id="cb26-100"><a href="#cb26-100"></a>  <span class="kw">text-indent</span><span class="ch">:</span> <span class="dv">-9999</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb26-101"><a href="#cb26-101"></a>  <span class="kw">-webkit-transform</span><span class="ch">:</span> <span class="fu">translateZ(</span><span class="dv">0</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb26-102"><a href="#cb26-102"></a>  <span class="kw">-ms-transform</span><span class="ch">:</span> <span class="fu">translateZ(</span><span class="dv">0</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb26-103"><a href="#cb26-103"></a>  <span class="kw">transform</span><span class="ch">:</span> <span class="fu">translateZ(</span><span class="dv">0</span><span class="fu">)</span><span class="op">;</span></span>
<span id="cb26-104"><a href="#cb26-104"></a>  <span class="kw">-webkit-animation-delay</span><span class="ch">:</span> <span class="dv">-0.16</span><span class="dt">s</span><span class="op">;</span></span>
<span id="cb26-105"><a href="#cb26-105"></a>  <span class="kw">animation-delay</span><span class="ch">:</span> <span class="dv">-0.16</span><span class="dt">s</span><span class="op">;</span></span>
<span id="cb26-106"><a href="#cb26-106"></a>}</span>
<span id="cb26-107"><a href="#cb26-107"></a><span class="fu">.loader</span><span class="in">:before</span><span class="op">,</span></span>
<span id="cb26-108"><a href="#cb26-108"></a><span class="fu">.loader</span><span class="in">:after</span> {</span>
<span id="cb26-109"><a href="#cb26-109"></a>  <span class="kw">content</span><span class="ch">:</span> <span class="st">&quot;&quot;</span><span class="op">;</span></span>
<span id="cb26-110"><a href="#cb26-110"></a>  <span class="kw">position</span><span class="ch">:</span> <span class="dv">absolute</span><span class="op">;</span></span>
<span id="cb26-111"><a href="#cb26-111"></a>  <span class="kw">top</span><span class="ch">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb26-112"><a href="#cb26-112"></a>}</span>
<span id="cb26-113"><a href="#cb26-113"></a><span class="fu">.loader</span><span class="in">:before</span> {</span>
<span id="cb26-114"><a href="#cb26-114"></a>  <span class="kw">left</span><span class="ch">:</span> <span class="dv">-3.5</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb26-115"><a href="#cb26-115"></a>  <span class="kw">-webkit-animation-delay</span><span class="ch">:</span> <span class="dv">-0.32</span><span class="dt">s</span><span class="op">;</span></span>
<span id="cb26-116"><a href="#cb26-116"></a>  <span class="kw">animation-delay</span><span class="ch">:</span> <span class="dv">-0.32</span><span class="dt">s</span><span class="op">;</span></span>
<span id="cb26-117"><a href="#cb26-117"></a>}</span>
<span id="cb26-118"><a href="#cb26-118"></a><span class="fu">.loader</span><span class="in">:after</span> {</span>
<span id="cb26-119"><a href="#cb26-119"></a>  <span class="kw">left</span><span class="ch">:</span> <span class="dv">3.5</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb26-120"><a href="#cb26-120"></a>}</span>
<span id="cb26-121"><a href="#cb26-121"></a><span class="im">@-webkit-keyframes</span> load7 {</span>
<span id="cb26-122"><a href="#cb26-122"></a>  0%<span class="op">,</span></span>
<span id="cb26-123"><a href="#cb26-123"></a>  80%<span class="op">,</span></span>
<span id="cb26-124"><a href="#cb26-124"></a>  100% {</span>
<span id="cb26-125"><a href="#cb26-125"></a>    <span class="kw">box-shadow</span><span class="ch">:</span> <span class="dv">0</span> <span class="dv">2.5</span><span class="dt">em</span> <span class="dv">0</span> <span class="dv">-1.3</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb26-126"><a href="#cb26-126"></a>  }</span>
<span id="cb26-127"><a href="#cb26-127"></a>  40% {</span>
<span id="cb26-128"><a href="#cb26-128"></a>    <span class="kw">box-shadow</span><span class="ch">:</span> <span class="dv">0</span> <span class="dv">2.5</span><span class="dt">em</span> <span class="dv">0</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb26-129"><a href="#cb26-129"></a>  }</span>
<span id="cb26-130"><a href="#cb26-130"></a>}</span>
<span id="cb26-131"><a href="#cb26-131"></a><span class="im">@keyframes</span> load7 {</span>
<span id="cb26-132"><a href="#cb26-132"></a>  <span class="dv">0%</span><span class="op">,</span></span>
<span id="cb26-133"><a href="#cb26-133"></a>  <span class="dv">80%</span><span class="op">,</span></span>
<span id="cb26-134"><a href="#cb26-134"></a>  <span class="dv">100%</span> {</span>
<span id="cb26-135"><a href="#cb26-135"></a>    <span class="kw">box-shadow</span><span class="ch">:</span> <span class="dv">0</span> <span class="dv">2.5</span><span class="dt">em</span> <span class="dv">0</span> <span class="dv">-1.3</span><span class="dt">em</span><span class="op">;</span></span>
<span id="cb26-136"><a href="#cb26-136"></a>  }</span>
<span id="cb26-137"><a href="#cb26-137"></a>  <span class="dv">40%</span> {</span>
<span id="cb26-138"><a href="#cb26-138"></a>    <span class="kw">box-shadow</span><span class="ch">:</span> <span class="dv">0</span> <span class="dv">2.5</span><span class="dt">em</span> <span class="dv">0</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb26-139"><a href="#cb26-139"></a>  }</span>
<span id="cb26-140"><a href="#cb26-140"></a>}</span></code></pre></div>
      <!-- ---------------------------------------- -->
    </main>

    <footer class="markdown-body">
      <p><a href="https://takeshiwada1980.github.io/Network-Exp-2024/">講義資料のIndexに移動</a></p>
    </footer>

    <script>
      window.onload = function () {
        // ナビゲーション関連
        let openBtn = document.getElementsByClassName("openbtn")[0];
        let navPnl = document.getElementById("g-nav");
        openBtn.onclick = () => {
          openBtn.classList.toggle("active");
          navPnl.classList.toggle("panelactive");
        };

        let items = navPnl.getElementsByTagName("a");
        Array.from(items).forEach((item) => {
          item.onclick = () => {
            openBtn.classList.toggle("active");
            navPnl.classList.toggle("panelactive");
          };
        });

        // マスク処理
        let maskedSpans = document.getElementsByClassName("masked");
        Array.from(maskedSpans).forEach((span) => {
          span.onclick = () => {
            span.classList.toggle("open");
          };
        });

        // data-startfrom 属性の行番号カウンタのリセット
        document.querySelectorAll("div.sourceCode").forEach(function (div) {
          var startFrom = div.getAttribute("data-startfrom");
          if (startFrom != null) {
            div.style.counterReset = "pg-line " + (startFrom - 1);
          }
        });

        // 画像にリンクを付与
        // let images = document.querySelectorAll("figure img");
        // Array.from(images).forEach((img) => {
        //   img.onclick = () => {
        //     location.href = img.getAttribute("src");
        //   };
        // });
      };
    </script>
  </body>
</html>
